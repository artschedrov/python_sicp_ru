\section{Создание абстракций с помощью функций}
\subsection{Введение}

Компьютерная наука - это чрезвычайно обширная академическая дисциплина. Области глобально распределенных систем, искусственного интеллекта, робототехники, графики, безопасности, научных вычислений, компьютерной архитектуры и десятки развивающихся подобластей каждый год пополняются новыми методами и открытиями. Стремительный прогресс компьютерной науки не затронул практически ни одного аспекта человеческой жизни. Коммерция, коммуникация, наука, искусство, досуг и политика - все они были переосмыслены как компьютерные области.

Огромная производительность компьютерной науки возможна только потому, что она построена на элегантном и мощном наборе фундаментальных идей. Все вычисления начинаются с представления информации, определения логики ее обработки и разработки абстракций, которые управляют сложностью этой логики. Овладение этими основами потребует от нас понимания того, как именно компьютеры интерпретируют компьютерные программы и выполняют вычислительные процессы.

Эти фундаментальные идеи уже давно преподаются в Беркли по классическому учебнику Structure and Interpretation of Computer Programs (\url{https://mitpress.mit.edu/9780262510875/structure-and-interpretation-of-computer-programs/}) Гарольда Абельсона и Джеральда Джея Сассмана с Джули Сассман. Эти конспекты лекций в значительной степени заимствованы из этого учебника, который авторы любезно разрешили адаптировать и использовать повторно.

Начало нашего интеллектуального путешествия не требует пересмотра, и мы не должны ожидать, что он когда-либо понадобится.


\begin{quotation}
Мы собираемся изучить идею вычислительного процесса. Вычислительные процессы - это абстрактные существа, которые населяют компьютеры. По мере своего развития процессы манипулируют другими абстрактными вещами, называемыми данными. Развитие процесса направляется шаблоном правил, называемым программой. Люди создают программы для управления процессами. По сути, мы вызываем духов компьютера с помощью наших заклинаний.

Программы, которые мы используем для управления процессами, похожи на заклинания колдуна. Они тщательно составляются из символических выражений на заумных и эзотерических языках программирования, которые определяют задачи, которые мы хотим, чтобы выполняли наши процессы.

Вычислительный процесс в правильно работающем компьютере выполняет программы точно и аккуратно. Поэтому, подобно ученику колдуна, начинающие программисты должны научиться понимать и предвидеть последствия своих колдовских действий.

-Абельсон и Сассман, SICP (1993)
\end{quotation}

\subsubsection{Программирование на языке Python}
\begin{quotation}
Язык - это не столько то, что вы изучаете, сколько то, к чему вы приобщаетесь.

-Арика Окрент
\end{quotation}

Чтобы определить вычислительные процессы, нам нужен язык программирования, желательно такой, который смогут понять как многие люди, так и множество компьютеров. В этом курсе мы будем изучать язык Python.

Python - это широко распространенный язык программирования, который привлек энтузиастов из многих профессий: веб-программистов, игровых инженеров, ученых, академиков и даже разработчиков новых языков программирования. Изучая Python, вы присоединяетесь к сообществу разработчиков, насчитывающему миллион человек. Сообщества разработчиков - это чрезвычайно важные институты: их члены помогают друг другу решать проблемы, делятся своим кодом и опытом, а также коллективно разрабатывают программное обеспечение и инструменты. Благодаря своему вкладу преданные члены сообщества часто становятся знаменитостями и пользуются всеобщим уважением. Возможно, когда-нибудь и вы окажетесь в числе этих элитных Питонистов.

Сам язык Python - это продукт большого сообщества добровольцев (\url{https://www.python.org/community/}), которое гордится разнообразием своих участников. Язык был задуман и впервые реализован Гвидо ван Россумом (\url{https://en.wikipedia.org/wiki/Guido_van_Rossum}) в конце 1980-х годов. В первой главе его учебника по Python 3 (\url{https://docs.python.org/3/tutorial/appetite.html}) объясняется, почему Python так популярен среди множества существующих сегодня языков.

Python отлично подходит в качестве учебного языка, поскольку на протяжении всей своей истории разработчики Python подчеркивали возможность интерпретации кода Python человеком, что подкреплялось руководящими принципами Zen of Python (\url{https://peps.python.org/pep-0020/}) - красотой, простотой и читабельностью. Python особенно подходит для этого курса, потому что его широкий набор функций поддерживает множество различных стилей программирования, которые мы и будем изучать. Хотя не существует единого способа программирования на Python, есть набор соглашений, разделяемых сообществом разработчиков, которые облегчают процесс чтения, понимания и расширения существующих программ. Таким образом, сочетание гибкости и доступности Python позволяет студентам изучить множество парадигм программирования, а затем применить полученные знания в тысячах текущих проектов (\url{https://pypi.org}).

Эти материалы поддерживают дух SICP, знакомя с особенностями Python в сочетании с методами проектирования абстракций и строгой моделью вычислений. Кроме того, эти материалы содержат практическое введение в программирование на Python, включая некоторые расширенные возможности языка и наглядные примеры. Изучение Python будет происходить естественно по мере прохождения курса.

Однако Python - богатый язык с множеством функций и возможностей, и мы сознательно вводим их постепенно, по мере того как накладываем слой фундаментальных концепций компьютерной науки. Опытным студентам, которые хотят быстро вникнуть во все тонкости языка, мы рекомендуем прочитать книгу Марка Пилгрима "Погружение в Python 3" (\url{https://diveintopython3.net}), которая находится в свободном доступе в Интернете. Темы в этой книге существенно отличаются от тем данного курса, но книга содержит очень ценную практическую информацию по использованию языка Python. Предупреждаем: в отличие от этих материалов, "Погружение в Python 3" предполагает наличие значительного опыта программирования.

Лучший способ начать программировать на Python - это напрямую взаимодействовать с интерпретатором. В этом разделе описано, как установить Python 3, инициировать интерактивный сеанс с интерпретатором и начать программировать.

\subsubsection{Установка Python 3}
Как и любое другое замечательное программное обеспечение, Python имеет множество версий. В этом курсе будет использоваться самая последняя стабильная версия Python 3 (в настоящее время Python 3.2). На многих компьютерах уже установлены более старые версии Python, но они не подойдут для этого курса. Вы можете использовать любой компьютер для этого курса, но вам придется установить Python 3. Не волнуйтесь, Python бесплатен.

В книге Dive Into Python 3 есть подробные инструкции по установке для всех основных платформ (\url{https://diveintopython3.net/installing-python.html}). В этих инструкциях несколько раз упоминается Python 3.1, но вам лучше использовать Python 3.2 (хотя для данного курса различия незначительны). На всех учебных машинах кафедры EECS уже установлен Python 3.2.

\subsubsection{Интерактивные сессии}
В интерактивном сеансе Python вы вводите код Python после подсказки >>>. Интерпретатор Python читает и оценивает то, что вы вводите, выполняя ваши различные команды.

Существует несколько способов начать интерактивную сессию, и они отличаются по своим свойствам. Попробуйте их все, чтобы понять, что вам больше нравится. Все они используют один и тот же интерпретатор за кулисами.
\begin{itemize}
  \item Самый простой и распространенный способ - запустить приложение Python 3. Введите python3 в строке терминала (Mac/Unix/Linux) или откройте приложение Python 3 в Windows.
  \item Более удобное приложение для тех, кто изучает язык, называется IDLE 3 (IDLE3). IDLE раскрашивает ваш код (это называется подсветкой синтаксиса), выводит подсказки по использованию и указывает на источник некоторых ошибок. IDLE всегда поставляется в комплекте с Python, так что вы уже установили его.
  \item Редактор Emacs может запускать интерактивную сессию внутри одного из своих буферов. Хотя изучение Emacs несколько сложнее, это мощный и универсальный редактор для любого языка программирования. Прочитайте учебник 61A по Emacs, чтобы начать работу. Многие программисты, потратившие время на изучение Emacs, больше никогда не переходят на другие редакторы.
\end{itemize}

В любом случае, если вы видите строку интерпретатора Python, >>>, значит, вы успешно начали интерактивный сеанс. В этом примере показан пример взаимодействия с использованием интерпретатора и последующего ввода.

\begin{lstlisting}
>>> 2 + 2
4
\end{lstlisting}

Элементы управления: В каждом сеансе сохраняется история набранных вами символов. Чтобы получить доступ к этой истории, нажмите <Control>-P (предыдущий) и <Control>-N (следующий). Выход из сеанса <Control>-D удаляет эту историю.

\subsubsection{Первый пример}
\begin{quotation}
И, когда воображение создает

Формы вещей неведомых, и перо поэта

Превращает их в формы и дает воздушному ничто

Местное жилище и имя.

- Уильям Шекспир, "Сон в летнюю ночь".
\end{quotation}

Чтобы ознакомить вас с Python, мы начнем с примера, в котором используются несколько возможностей языка. В следующем разделе нам придется начать с нуля и создавать язык по частям. Воспринимайте этот раздел как предварительный просмотр будущих мощных возможностей.

В Python встроена поддержка широкого спектра распространенных операций программирования, таких как работа с текстом, отображение графики и общение через Интернет.

Оператор импорта

\begin{lstlisting}
>>> from urllib.request import urlopen
\end{lstlisting}

загружает функциональность для доступа к данным в Интернете. В частности, она делает доступной функцию urlopen, которая может получить доступ к содержимому по унифицированному локатору ресурсов (URL), который представляет собой местоположение чего-либо в Интернете.

Инструкции и выражения. Код Python состоит из инструкций и выражений. В общем случае компьютерные программы состоят из инструкций, направленных либо на:

\begin{enumerate}
  \item Вычислить некоторое значение
  \item Выполнить некоторое действие
\end{enumerate}

Инструкции обычно описывают действия. Когда интерпретатор Python выполняет инструкцию, он выполняет соответствующее действие. С другой стороны, выражения обычно описывают вычисления, которые дают значения. Когда Python вычисляет выражение, он вычисляет его значение. В этой главе мы познакомимся с несколькими типами инструкций и выражений.

Инструкция по присвоению

\begin{lstlisting}
>>> shakespeare = urlopen('http://inst.eecs.berkeley.edu/~cs61a/fa11/shakespeare.txt')
\end{lstlisting}

связывает имя shakespeare со значением выражения, которое следует за ним. Это выражение применяет функцию urlopen к URL-адресу, содержащему полный текст 37 пьес Уильяма Шекспира в одном текстовом документе.

Функции.
В функциях заключена логика, которая манипулирует данными.
Веб-адрес - это часть данных, а текст пьес Шекспира - другая.
Процесс, в результате которого первое приводит ко второму, может быть сложным, но мы можем применить этот процесс, используя лишь простое выражение, потому что эта сложность скрыта в функции.
Функции - основная тема этой главы.

Еще одна инструкция о присвоении

\begin{lstlisting}
>>> words = set(shakespeare.read().decode().split())
\end{lstlisting}

связывает имя words с набором всех уникальных слов, которые встречаются в пьесах Шекспира, - всего их 33 721. Цепочка команд чтения (read), декодирования (decode) и разбиения (split) оперирует с промежуточным вычислительным объектом: данные считываются из открытого URL, эти данные декодируются в текст, а текст разбивается на слова. Все эти слова помещаются в набор (set).

Объекты. Набор (set) - это тип объекта, который поддерживает такие операции с наборами, как вычисление пересечений и проверка принадлежности. Объект легко объединяет данные и логику, которая манипулирует этими данными, таким образом, чтобы скрыть сложность того и другого. Объекты являются основной темой главы 2.

Выражение

\begin{lstlisting}
>>> {w for w in words if len(w) >= 5 and w[::-1] in words}
{'madam', 'stink', 'leets', 'rever', 'drawer', 'stops', 'sessa',
'repaid', 'speed', 'redder', 'devil', 'minim', 'spots', 'asses',
'refer', 'lived', 'keels', 'diaper', 'sleek', 'steel', 'leper',
'level', 'deeps', 'repel', 'reward', 'knits'}
\end{lstlisting}

это составное выражение, которое оценивает набор шекспировских слов, встречающихся как в прямом, так и в обратном порядке. Загадочная нотация w[::-1] перечисляет каждую букву в слове, но -1 говорит о том, что нужно двигаться назад (:: здесь означает, что позиции первого и последнего символов для перечисления заданы по умолчанию). Когда вы вводите выражение в интерактивной сессии, Python печатает его значение в следующей строке, как показано на рисунке.

Интерпретаторы. Вычисление составных выражений требует точной процедуры, которая интерпретирует код предсказуемым образом. Программа, реализующая такую процедуру, вычисляющая составные выражения и утверждения, называется интерпретатором. Проектирование и реализация интерпретаторов - основная тема главы 3.

По сравнению с другими компьютерными программами, интерпретаторы языков программирования уникальны своей общностью. Python не был разработан с расчетом на Шекспира или палиндромы. Однако его большая гибкость позволила нам обработать большой объем текста всего в нескольких строках кода.

В итоге мы увидим, что все эти основные понятия тесно связаны между собой: функции - это объекты, объекты - это функции, а интерпретаторы - это элементы тех и других. Однако четкое понимание каждой из этих концепций и их роли в организации кода имеет решающее значение для овладения искусством программирования.

